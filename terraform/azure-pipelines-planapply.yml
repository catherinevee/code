variables:
  storageAccountName: "tfstatesa"
  containerName: "tfstate-container"
  terraform_version: 1.11.3
  resourceGroup: "polandcentralrg-1"
  backendServiceArm: "catherinevee_manid"
  backendAzureRmResourceGroupName: $(resourceGroup)
  backendAzureRmStorageAccountName: $(storageAccountName)
  backendAzureRmContainerName: $(containerName)
  backendAzureRmKey: "terraform.tfstate"
 

trigger:
- main
name: $(BuildDefinitionName)_$(date:yyyyMMdd)$(rev:.r) 
pr: none


stages :  
  - stage: terraform_plan_apply
    jobs:
      - job: terraform_apply
        steps:
          - task: AzureCLI@2
            inputs:
              azureSubscription: 'catherinevee_manid'
              scriptType: 'bash'
              scriptLocation: 'inlineScript'
              inlineScript: 'az login --identity --client-id 259e201e-2c35-46e1-9908-4e93331d6de5'
            env:
              AZURE_SUBSCRIPTION_ID: $(ARM_SUBSCRIPTION_ID)
              AZURE_CLIENT_ID: $(AZURE_CLIENT_ID)
              AZURE_TENANT_ID: $(AZURE_TENANT_ID)              
              AZURE_CLIENT_SECRET: $(AZURE_CLIENT_SECRET)
              AZD_INITIAL_ENVIRONMENT_CONFIG: $(AZD_INITIAL_ENVIRONMENT_CONFIG)
         